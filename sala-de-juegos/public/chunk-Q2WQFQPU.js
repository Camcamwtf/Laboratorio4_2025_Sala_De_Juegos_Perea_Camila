import{a as U}from"./chunk-N3U35V2V.js";import{a as N}from"./chunk-KKQE5UGW.js";import{a as j,b as T}from"./chunk-BKROMZOD.js";import"./chunk-L645W6BM.js";import{a as A}from"./chunk-NTEOFLDB.js";import{a as R}from"./chunk-3K5F4FNC.js";import"./chunk-5YNXMIIZ.js";import"./chunk-E4ERW3Q5.js";import{a as k,b as D}from"./chunk-G24662RJ.js";import{$a as b,$b as u,Ab as E,Cc as w,Dc as S,Fb as d,Gc as y,Hc as I,Pa as r,Pb as m,Qb as M,Sb as i,Tb as p,Ub as x,Xb as P,Yb as h,_,_b as C,db as c,na as g,nb as f,sb as l,tb as a,ub as n,zb as v}from"./chunk-TXKU6S6B.js";import{j as O}from"./chunk-4ZZIO3ZI.js";var $=()=>[1,2,3,4,5];function G(t,o){if(t&1&&(a(0,"div",13)(1,"div",14)(2,"span",15),i(3),n()(),a(4,"div",16)(5,"div",17),i(6,"Puntos: "),a(7,"b"),i(8),n(),i(9),n()(),a(10,"div",18)(11,"div",19),i(12),h(13,"date"),n()()()),t&2){let e=o.$implicit;r(2),f("data-juego",e.juego),r(),p(e.juego),r(5),p(e.puntaje),r(),x(" \u2014 ",e.gano?"Ganado":"Perdido"),r(3),p(C(13,5,e.fechaISO,"short"))}}function J(t,o){if(t&1&&(a(0,"div",11),c(1,G,14,8,"div",12),n()),t&2){let e=d(2);r(),l("ngForOf",e.resultados())}}function B(t,o){if(t&1&&(v(0),c(1,J,2,1,"div",10),E()),t&2){let e=d(),s=m(12);r(),l("ngIf",e.resultados().length>0)("ngIfElse",s)}}function H(t,o){t&1&&(a(0,"div",20)(1,"mat-icon",21),i(2,"autorenew"),n(),a(3,"span"),i(4,"Cargando resultados..."),n()())}function V(t,o){t&1&&(a(0,"div",22)(1,"mat-icon"),i(2,"info"),n(),a(3,"span"),i(4,"Sin resultados registrados."),n()())}function Y(t,o){if(t&1&&(a(0,"mat-icon"),i(1,"star"),n()),t&2){let e=o.$implicit,s=d().$implicit;M("active",e<=s.puntaje)}}function q(t,o){if(t&1&&(a(0,"div",27),i(1),n()),t&2){let e=d().$implicit;r(),x("\u201C",e.comentario,"\u201D")}}function K(t,o){if(t&1&&(a(0,"div",13)(1,"div",14)(2,"span",15),i(3),n()(),a(4,"div",16)(5,"div",17)(6,"span",23),c(7,Y,2,2,"mat-icon",24),n(),a(8,"span",25),i(9),n()(),c(10,q,2,1,"div",26),n(),a(11,"div",18)(12,"div",19),i(13),h(14,"date"),n()()()),t&2){let e=o.$implicit;r(2),f("data-juego",e.juego),r(),p(e.juego),r(3),f("aria-label","Puntaje "+e.puntaje+" de 5"),r(),l("ngForOf",P(10,$)),r(2),x("",e.puntaje,"/5"),r(),l("ngIf",e.comentario),r(3),p(C(14,7,e.fechaISO,"short"))}}function L(t,o){if(t&1&&(a(0,"div",11),c(1,K,15,11,"div",12),n()),t&2){let e=d(3);r(),l("ngForOf",e.encuestas())}}function Q(t,o){if(t&1&&(v(0),c(1,L,2,1,"div",10),E()),t&2){d();let e=m(8),s=d();r(),l("ngIf",s.encuestas().length>0)("ngIfElse",e)}}function W(t,o){t&1&&(a(0,"div",20)(1,"mat-icon",21),i(2,"autorenew"),n(),a(3,"span"),i(4,"Cargando encuestas..."),n()())}function X(t,o){t&1&&(a(0,"div",22)(1,"mat-icon"),i(2,"info"),n(),a(3,"span"),i(4,"Sin encuestas registradas."),n()())}function Z(t,o){if(t&1&&(a(0,"section",6)(1,"header",7)(2,"h2"),i(3,"Mis Encuestas"),n()(),c(4,Q,2,2,"ng-container",8)(5,W,5,0,"ng-template",null,2,u)(7,X,5,0,"ng-template",null,3,u),n()),t&2){let e=m(6),s=d();r(4),l("ngIf",!s.cargandoEncuestas())("ngIfElse",e)}}var F=class t{auth=_(R);results=_(A);encuestasSrv=_(U);resultados=g([]);encuestas=g([]);cargandoResultados=g(!0);cargandoEncuestas=g(!0);esAdmin=N(this.auth.esAdmin$,{initialValue:!1});ngOnInit(){return O(this,null,function*(){let o=yield this.auth.getUsuarioActual();if(!o){this.cargandoResultados.set(!1),this.cargandoEncuestas.set(!1);return}try{let e=yield this.results.listarPorUsuario(o.id);this.resultados.set(e.map(s=>({juego:s.JUEGO,puntaje:s.PUNTAJE,gano:s.GANO,fechaISO:s.CREATED_AT??new Date().toISOString()})))}finally{this.cargandoResultados.set(!1)}try{let e=yield this.encuestasSrv.listarPorUsuario(o.id);this.encuestas.set(e.map(s=>({juego:s.JUEGO,puntaje:s.PUNTAJE,comentario:s.COMENTARIO??null,fechaISO:s.FECHA??new Date().toISOString()})))}finally{this.cargandoEncuestas.set(!1)}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=b({type:t,selectors:[["ng-component"]],decls:14,vars:3,consts:[["cargaResultadosTpl",""],["sinResultadosTpl",""],["cargaEncuestasTpl",""],["sinEncuestasTpl",""],["appearance","outlined",1,"estadisticas-card","split","estadisticas-card--shadow","estadisticas-card--hover"],[1,"estadisticas-div"],[1,"panel"],[1,"panel-header"],[4,"ngIf","ngIfElse"],["class","panel",4,"ngIf"],["class","lista",4,"ngIf","ngIfElse"],[1,"lista"],["class","row",4,"ngFor","ngForOf"],[1,"row"],[1,"row-left"],[1,"badge"],[1,"row-center"],[1,"row-title"],[1,"row-right"],[1,"fecha"],[1,"loading"],[1,"spin"],[1,"sin-datos"],[1,"estrellas"],[3,"active",4,"ngFor","ngForOf"],[1,"puntaje-text"],["class","row-meta comentario",4,"ngIf"],[1,"row-meta","comentario"]],template:function(e,s){if(e&1&&(a(0,"mat-card",4)(1,"div",5)(2,"h1"),i(3,"Estad\xEDsticas"),n(),a(4,"section",6)(5,"header",7)(6,"h2"),i(7,"Mis Resultados"),n()(),c(8,B,2,2,"ng-container",8)(9,H,5,0,"ng-template",null,0,u)(11,V,5,0,"ng-template",null,1,u),n(),c(13,Z,9,2,"section",9),n()()),e&2){let z=m(10);r(8),l("ngIf",!s.cargandoResultados())("ngIfElse",z),r(5),l("ngIf",!s.esAdmin())}},dependencies:[I,w,S,D,k,T,j,y],styles:["[_nghost-%COMP%]{align-self:start;justify-self:center;width:100%}.estadisticas-card[_ngcontent-%COMP%]{height:460px!important;width:min(96vw,1000px)!important;margin:0 auto;box-sizing:border-box;background:#101424db;border:1px solid rgba(130,160,255,.15);transition:box-shadow .2s ease,transform .2s ease}.estadisticas-card.split[_ngcontent-%COMP%]{width:min(96vw,1000px);margin:0 auto;padding:0;overflow:hidden;box-sizing:border-box;border-radius:20px}.estadisticas-card--hover[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 16px 40px #0000006b,0 6px 18px #00000047,0 0 0 1px #00000038}.estadisticas-div[_ngcontent-%COMP%]{display:grid;gap:16px;padding:24px 28px}h1[_ngcontent-%COMP%]{margin:0!important;color:var(--color-secondary)}.panel[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr;gap:6px}.panel[_ngcontent-%COMP%]   .lista[_ngcontent-%COMP%]{height:140px;overflow-y:auto;padding-right:6px}.panel[_ngcontent-%COMP%]   .lista[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.panel[_ngcontent-%COMP%]   .lista[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#a89eff47;border-radius:999px}.panel[_ngcontent-%COMP%]   .lista[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff0f;border-radius:999px}.panel-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;color:var(--color-tertiary)}.lista[_ngcontent-%COMP%]{max-height:150px;overflow:auto;border:1px solid rgba(130,160,255,.15);border-radius:12px;background:#10142480}.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:start;padding:10px 12px;border-bottom:1px solid rgba(130,160,255,.12)}.row[_ngcontent-%COMP%]:last-child{border-bottom:0}.row-left[_ngcontent-%COMP%]{align-self:center}.row-center[_ngcontent-%COMP%]{display:grid;align-self:center;gap:4px}.row-right[_ngcontent-%COMP%]{text-align:right;align-self:center;white-space:nowrap}.row-title[_ngcontent-%COMP%]{font-weight:700}.fecha[_ngcontent-%COMP%]{opacity:.9;font-size:12px}.badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.18);background:var(--color-violet);color:var(--texto-principal);font-weight:700;text-transform:lowercase}.badge[data-juego=ahorcado][_ngcontent-%COMP%]{background:var(--color-light-violet);color:var(--texto-secundario)}.badge[data-juego=mayor-menor][_ngcontent-%COMP%]{background:var(--color-tertiary);color:var(--texto-secundario)}.badge[data-juego=preguntados][_ngcontent-%COMP%]{background:var(--color-primary);color:var(--texto-principal)}.badge[data-juego=arkanoid][_ngcontent-%COMP%]{background:var(--color-secondary);color:var(--texto-principal)}.loading[_ngcontent-%COMP%], .sin-datos[_ngcontent-%COMP%]{display:grid;place-items:center;gap:8px;padding:16px;color:#bcd7ff}.loading[_ngcontent-%COMP%]   .spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite;color:var(--color-light-violet)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.sin-datos[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;height:28px;width:28px;color:var(--color-light-violet)}.estrellas[_ngcontent-%COMP%]{display:inline-flex;gap:2px;vertical-align:middle}.estrellas[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;opacity:.35}.estrellas[_ngcontent-%COMP%]   .mat-icon.active[_ngcontent-%COMP%]{opacity:1;color:var(--color-tertiary)}.puntaje-text[_ngcontent-%COMP%]{margin-left:6px;font-size:12px;opacity:.9}.comentario[_ngcontent-%COMP%]{font-style:italic}"]})};export{F as Estadisticas};
