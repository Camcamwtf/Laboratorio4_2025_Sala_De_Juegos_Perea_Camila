<div class="encuestas-container">
  <!-- #region División principal -->
  <mat-card class="encuestas-card split encuestas-card--shadow-m encuestas-card--hover" appearance="outlined">
    <header class="encabezado">
      <h1>Encuestas</h1>
      <h3>Respuestas de usuarios (solo Administrador)</h3>
    </header>

    <section class="filtros">
      <mat-form-field appearance="outline" class="filtro">
        <mat-label>Buscar respuesta</mat-label>
        <input matInput (keyup)="aplicarFiltro($event.target.value)" placeholder="Email, juego, puntaje, comentario..." />
      </mat-form-field>
    </section>

    <section class="tabla-wrapper" *ngIf="!cargando(); else cargandoTpl">
      <table mat-table [dataSource]="dataSource" class="mat-elevation-z1">

        <!-- #region Usuario -->
        <ng-container matColumnDef="usuarioEmail">
          <th mat-header-cell *matHeaderCellDef> Usuario </th>
          <td mat-cell *matCellDef="let r" class="texto-grilla">{{ r.usuarioEmail }}</td>
        </ng-container>
        <!-- #endregion -->

        <!-- #region Juego -->
        <ng-container matColumnDef="juego">
          <th mat-header-cell *matHeaderCellDef> Juego </th>
          <td mat-cell *matCellDef="let r">
            <span class="badge">{{ r.juego }}</span>
          </td>
        </ng-container>
        <!-- #endregion -->

        <!-- #region Puntaje -->
        <ng-container matColumnDef="puntaje">
          <th mat-header-cell *matHeaderCellDef> Puntaje </th>
          <td mat-cell *matCellDef="let r">{{ r.puntaje }}</td>
        </ng-container>
        <!-- #endregion -->

        <!-- #region Fecha -->
        <ng-container matColumnDef="fecha">
          <th mat-header-cell *matHeaderCellDef> Fecha </th>
          <td mat-cell *matCellDef="let r">{{ r.fechaISO | date:'short' }}</td>
        </ng-container>
        <!-- #endregion -->

        <!-- #region Comentario -->
        <ng-container matColumnDef="comentario">
          <th mat-header-cell *matHeaderCellDef> Comentario </th>
          <td mat-cell *matCellDef="let r">{{ r.comentario || '—' }}</td>
        </ng-container>
        <!-- #endregion -->

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <div class="sin-datos" *ngIf="dataSource.data.length === 0">
        <mat-icon>info</mat-icon>
        <span>No hay respuestas registradas.</span>
      </div>
    </section>

    <ng-template #cargandoTpl>
      <div class="loading">
        <mat-icon class="spin">autorenew</mat-icon>
        <span>Cargando respuestas...</span>
      </div>
    </ng-template>
  </mat-card>
  <!-- #endregion -->
</div>
